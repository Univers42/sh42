<!doctype html>
<html lang="en" data-theme="light">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Hellish â€” Project Documentation</title>
    <link rel="stylesheet" href="page/styles.css" />
    <link rel="stylesheet" href="page/style_hellish.css"/>
    <!-- Ensure modular styles are loaded directly so refactor changes appear immediately -->
    <link rel="stylesheet" href="page/theme.css" />
    <link rel="stylesheet" href="page/brand.css" />
    <link rel="stylesheet" href="page/nav.css" />
    <link rel="stylesheet" href="page/entry.css" />
    <link rel="stylesheet" href="page/layout.css" />
    <link rel="stylesheet" href="page/components.css" />
    <link rel="stylesheet" href="page/button.css" />
    <link rel="stylesheet" href="page/mobile_menu.css" />
    <link rel="stylesheet" href="page/media.css" />
    <!-- main.js is loaded at the end of the body with defer -->
</head>

<body class="bg-gray-50 text-dark">
  <!-- Site header: animated gradient, brand, navigation and controls -->
  <header class="site-header" role="banner" aria-label="Main header">
    <div class="header-bg gradient-animated" aria-hidden="true"></div>
    <div class="navbar-container header-inner">
      <a class="navbar-brand header-brand" href="#" onclick="scrollToTop(event)" aria-label="Hellish home">
        <div class="brand-logo header-logo"><span>H!</span></div>
        <div class="brand-text">
          <h1>Hellish</h1>
          <p class="brand-sub">POSIX-like shell â€¢ lightweight & extensible</p>
        </div>
      </a>

      <nav class="navbar-nav" role="navigation" aria-label="Primary navigation">
        <ul class="nav-list" role="menubar">
          <li role="none"><a role="menuitem" class="nav-link" href="#overview">Overview</a></li>
          <li role="none"><a role="menuitem" class="nav-link" href="#architecture">Architecture</a></li>
          <li role="none"><a role="menuitem" class="nav-link" href="#getting-started">Getting started</a></li>
          <li role="none"><a role="menuitem" class="nav-link" href="#commands">Commands</a></li>
          <li role="none"><a role="menuitem" class="nav-link" href="#contributing">Contribute</a></li>
        </ul>
      </nav>

      <div class="header-controls" role="group" aria-label="Header controls">
        <button id="themeToggle" class="theme-toggle theme-toggle-btn" aria-pressed="false" aria-label="Toggle theme">
          <span class="theme-icon sun">â˜€ï¸</span>
          <span class="theme-icon moon">ğŸŒ™</span>
        </button>

        <button class="btn btn-primary header-cta" onclick="location.href='#getting-started'">Get Started</button>

        <button class="mobile-toggle" id="mobileToggle" aria-label="Open mobile menu" aria-expanded="false">
          <span></span><span></span><span></span>
        </button>
      </div>
    </div>

    <!-- subtle decorative svg for depth (adaptive color via CSS) -->
    <svg class="header-decor" viewBox="0 0 1200 120" preserveAspectRatio="none" aria-hidden="true">
      <path d="M0,0 C300,100 900,0 1200,80 L1200,120 L0,120 Z"></path>
    </svg>
  </header>

  <div class="mobile-menu" id="mobileMenu">
    <div class="mobile-menu-content">
      <a class="mobile-menu-link" href="#overview">Overview</a>
      <a class="mobile-menu-link" href="#architecture">Architecture</a>
      <a class="mobile-menu-link" href="#getting-started">Getting Started</a>
      <a class="mobile-menu-link" href="#commands">Commands</a>
      <a class="mobile-menu-link" href="#contributing">Contributing</a>
    </div>
  </div>

  <main style="padding-top:100px;">
    <!-- Entry overlay: full-screen, shown on first load. Picks an app area and reveals the docs SPA. -->
    <div id="entryOverlay" class="entry-overlay" role="dialog" aria-modal="true" aria-labelledby="entryTitle">
      <div class="entry-inner">
        <header class="entry-header">
          <div class="entry-brand">
            <div class="entry-logo">H!</div>
            <div>
              <h2 id="entryTitle">Welcome to Hellish</h2>
              <p class="entry-sub">Pick where you want to go â€” quick access to docs, examples and tools.</p>
            </div>
          </div>
          <button id="entryClose" class="btn btn-sm" aria-label="Close welcome">Skip</button>
        </header>

        <div class="entry-grid auto-grid tight" role="menu" aria-label="Quick actions">
          <button class="entry-tile feature-card" data-target="overview" role="menuitem" aria-label="Open Documentation">
            <div class="feature-icon gradient-primary">ğŸ“š</div>
            <div class="feature-title">Documentation</div>
            <div class="feature-description">Complete manual & API â€” start reading the docs.</div>
          </button>

          <button class="entry-tile feature-card" data-target="getting-started" role="menuitem" aria-label="Getting started">
            <div class="feature-icon gradient-success">âš™ï¸</div>
            <div class="feature-title">Getting started</div>
            <div class="feature-description">Clone, build and try the REPL locally.</div>
          </button>

          <button class="entry-tile feature-card" data-target="commands" role="menuitem" aria-label="Commands & plugins">
            <div class="feature-icon gradient-warning">ğŸ”§</div>
            <div class="feature-title">Commands</div>
            <div class="feature-description">Explore command & plugin model.</div>
          </button>

          <button class="entry-tile feature-card" data-target="architecture" role="menuitem" aria-label="Architecture">
            <div class="feature-icon gradient-purple">ğŸ—ï¸</div>
            <div class="feature-title">Architecture</div>
            <div class="feature-description">Repository layout & design choices.</div>
          </button>

          <button class="entry-tile feature-card" data-action="contribute" role="menuitem" aria-label="Contribute">
            <div class="feature-icon gradient-pink">ğŸ¤</div>
            <div class="feature-title">Contribute</div>
            <div class="feature-description">Guide for contributing and PR workflow.</div>
          </button>

          <button class="entry-tile feature-card" data-action="search" role="menuitem" aria-label="Search">
            <div class="feature-icon gradient-ocean">ğŸ”</div>
            <div class="feature-title">Search</div>
            <div class="feature-description">Instant search across docs (local).</div>
          </button>
        </div>
        <footer class="entry-foot">Press <kbd>Esc</kbd> to dismiss</footer>
      </div>
    </div>

    <div class="container-fluid mt-8 layout-root">
      <!-- doc-wrap: left article column (can expand) + right sticky aside -->
      <div class="doc-wrap">
        <!-- Article column -->
        <div class="article-col">
          <div class="article-stage">
            <!-- overview article (unchanged content) -->
            <article id="overview" class="component-card mt-6 active">
              <div class="component-info">
                <h2 class="component-title">Overview</h2>
                <p class="component-description">
                  Hellish offers a compact command-line interface with a small core engine and an extension system for
                  adding commands, completions, and pipelines. It was created with three goals:
                </p>
                <ul>
                  <li>Minimal footprint â€” small binary, small dependency surface.</li>
                  <li>Composability â€” simple pipes & streaming of structured events.</li>
                  <li>Extensibility â€” easy to add commands as plugins or in-process modules.</li>
                </ul>

                <h3 class="mt-4">Who is this for?</h3>
                <p class="component-description">Developers who need an easily scriptable shell that can be embedded or extended in automation pipelines.</p>

                <h3 class="mt-4">What this doc covers</h3>
                <ul>
                  <li>Project architecture & directories</li>
                  <li>Command/plugin model</li>
                  <li>Styling & UI components used in this docs (the CSS you provided)</li>
                  <li>How to build, test and contribute</li>
                </ul>
              </div>
            </article>

            <!-- architecture article -->
            <article id="architecture" class="component-card mt-6">
              <div class="component-info">
                <h2 class="component-title">Architecture</h2>
                <p class="component-description">
                  Hellish follows a layered C-based design reflecting the repository layout below:
                </p>

                <h4 class="mt-4">Repository tree (actual)</h4>
                <div class="doc-code" style="margin-top:0.75rem;">
<pre>
.
â”œâ”€â”€ docs
â”‚   â”œâ”€â”€ manual
â”‚   â””â”€â”€ sys
â”œâ”€â”€ incs
â”œâ”€â”€ lab
â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ glob
â”‚   â”œâ”€â”€ libarena
â”‚   â”œâ”€â”€ libft
â”‚   â”œâ”€â”€ liblex
â”‚   â”œâ”€â”€ libmalloc
â”‚   â”œâ”€â”€ libreadline
â”‚   â”œâ”€â”€ libregexp
â”‚   â”œâ”€â”€ libvar
â”‚   â”œâ”€â”€ sh
â”‚   â”œâ”€â”€ sig
â”‚   â”œâ”€â”€ termcap
â”‚   â”œâ”€â”€ tilde
â”‚   â””â”€â”€ wctype
â”œâ”€â”€ scripts
â”‚   â””â”€â”€ hooks
â””â”€â”€ srcs
    â”œâ”€â”€ executor
    â”œâ”€â”€ expander
    â”œâ”€â”€ globbing
    â”œâ”€â”€ parser
    â”œâ”€â”€ shell
    â””â”€â”€ utils
</pre>
                </div>

                <h4 class="mt-4">Key design choices</h4>
                <ul>
                  <li><strong>Structured streams</strong> â€” passing JSON-like events between commands instead of raw text reduces parsing in every tool.</li>
                  <li><strong>Single-threaded runtime</strong> â€” simplicity first; non-blocking IO uses async primitives and optional worker pools.</li>
                  <li><strong>Plugin interface</strong> â€” minimal surface area so bindings into other languages (Python, Node) are possible later.</li>
                </ul>
              </div>
            </article>

            <!-- getting-started article -->
            <article id="getting-started" class="component-card mt-6">
              <div class="component-info">
                <h2 class="component-title">Getting started</h2>
                <p class="component-description">Quick steps to clone, build and try Hellish locally.</p>

                <h4>Prerequisites</h4>
                <ul>
                  <li>GNU Make, GCC, and the readline development headers.</li>
                </ul>

                <h4 class="mt-3">Clone & build</h4>
                <div class="doc-code">
<pre>
git clone --recursive git@github.com:Univers42/hellish.git
cd hellish
make
./hellish --version
</pre>
                </div>

                <h4 class="mt-3">Run the REPL</h4>
                <div class="doc-code">
<pre>
./hellish
# prompt:
hellish> echo "hello"
hello
hellish> help
</pre>
                </div>

                <h4 class="mt-3">Configuration</h4>
                <p class="component-description">Create <code>~/.hellishrc</code> to set defaults and aliases:</p>
                <div class="doc-code">
<pre>
# ~/.hellishrc
alias ll="ls -la"
set prompt="hellish> "
# plugin enables
plugins:
  - filewatch
</pre>
                </div>

              </div>
            </article>

            <!-- commands article -->
            <article id="commands" class="component-card mt-6">
              <div class="component-info">
                <h2 class="component-title">Commands & Plugin model</h2>

                <h4>Command signature</h4>
                <p class="component-description">Each command implements a small interface (pseudocode):</p>
                <div class="doc-code">
<pre>
type Command interface {
  Name() string
  Help() string
  Run(ctx Context, in Stream) (out Stream, err error)
}
</pre>
                </div>

                <h4 class="mt-3">How to write a plugin (high level)</h4>
                <ol>
                  <li>Create a module under plugins/<your-plugin></li>
                  <li>Implement the Command interface</li>
                  <li>Register the command in the plugin init() or via a registry file</li>
                  <li>Document flags and examples</li>
                </ol>

                <h4 class="mt-3">Example: small 'upper' plugin</h4>
                <div class="doc-code">
<pre>
# pseudocode
plugin UpperCmd {
  Name() => "upper"
  Help() => "reads lines and emits uppercased text"
  Run(ctx, in) {
    return in.Map(line => strings.ToUpper(line))
  }
}
</pre>
                </div>

                <h4 class="mt-3">Pipes and structured events</h4>
                <p class="component-description">Hellish pipes carry events with metadata. Example:</p>
                <div class="doc-code">
<pre>
# pipeline
ls --json | filter size>1MB | upload --target s3://bucket

# structured event example emitted from ls:
{ "type":"file", "name":"foo.zip", "size": 10485760, "path":"/tmp/foo.zip" }
</pre>
                </div>
              </div>
            </article>

            <article class="component-card mt-6">
              <div class="component-info">
                <h2 id="styling" class="component-title">Docs & UI styling (how this page is built)</h2>

                <p class="component-description">This documentation uses the CSS file you provided. Key utilities & components used here:</p>
                <ul>
                  <li><strong>Layout</strong>: .container, .row, .col-*</li>
                  <li><strong>Hero</strong>: .hero, .hero-title, .hero-subtitle, .hero-stats</li>
                  <li><strong>Cards & Components</strong>: .component-card, .component-info, .component-preview</li>
                  <li><strong>Utilities</strong>: spacing (.m-*, .p-*), text helpers (.text-*, .font-*) and grid classes (.grid-cols-3)</li>
                </ul>

                <h4 class="mt-3">How to pick classes</h4>
                <p class="component-description">
                  Prefer semantic components for pages (component-card, feature-grid) and utility classes for micro layout adjustments.
                  Because the CSS includes many expressive utility classes, avoid deep nesting and prefer:
                </p>
                <div class="doc-code">
<pre>
<!-- preferred -->
<div class="component-card">
  <div class="component-info">...</div>
</div>

<!-- avoid: lots of selector overrides -->
<div class="component-card">
  <div class="component-info">
    <div class="some-inner">...</div>
  </div>
</div>
</pre>
                </div>

                <h4 class="mt-3">Responsive tips</h4>
                <ul>
                  <li>Use grid helpers like .auto-grid or .component-grid.compact for collections of items.</li>
                  <li>For navigation, .navbar-menu toggles at 768px and .mobile-menu shows on mobile.</li>
                </ul>
              </div>
            </article>

            <article class="component-card mt-6">
              <div class="component-info">
                <h2 id="testing" class="component-title">Testing & CI</h2>
                <p class="component-description">Tests should cover parser, runtime, and common plugin integrations.</p>

                <h4>Suggested test matrix</h4>
                <ul>
                  <li>Unit tests for parser AST correctness and runtime execution</li>
                  <li>Integration tests that spin up the REPL and run common pipelines</li>
                  <li>Plugin contract tests ensuring the Command interface invariants</li>
                </ul>

                <h4 class="mt-3">CI example (GitHub Actions)</h4>
                <div class="doc-code">
<pre>
name: CI
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Set up Go
        uses: actions/setup-go@v4
        with: go-version: '1.20'
      - name: Build
        run: make build
      - name: Test
        run: make test
</pre>
                </div>

              </div>
            </article>

            <article class="component-card mt-6">
              <div class="component-info">
                <h2 id="contributing" class="component-title">Contributing</h2>

                <p class="component-description">We welcome contributions! Recommended workflow:</p>
                <ol>
                  <li>Open an issue describing your plan, referencing "enhancement" or "bug".</li>
                  <li>Fork, create a feature branch named feat/<short-description> or fix/<issue-number>.</li>
                  <li>Run tests locally, add unit tests for new features.</li>
                  <li>Open a PR with a clear description and link to the issue.</li>
                </ol>

                <h4 class="mt-3">Code style</h4>
                <p class="component-description">Follow the project's linting rules (gofmt / prettier). Keep functions small and modular.</p>

                <h4 class="mt-3">Commit message format</h4>
                <div class="doc-code">
<pre>
feat(parser): support binary literal parsing
fix(runtime): avoid deadlock on empty pipeline
docs: update README with plugin example
</pre>
                </div>

                <h4 class="mt-3">Maintainer notes</h4>
                <ul>
                  <li>Label PRs with "area/parser", "area/runtime", "area/docs" as appropriate.</li>
                  <li>Run the full integration tests before merging breaking changes.</li>
                </ul>

              </div>
            </article>

          </div>
        </div>

        <!-- Right bubble-aside: draggable bubble that expands into the docs nav -->
        <aside class="doc-aside bubble" id="docBubble" aria-label="Floating documentation bubble" aria-hidden="false">
          <!-- floating handle / collapsed UI -->
          <button id="bubbleHandle" class="bubble-handle" aria-label="Open documentation" title="Drag to move â€” click to open" aria-expanded="false">â˜°</button>

          <!-- expanded card (same nav content reused) -->
          <div class="doc-aside-card component-card mt-6" id="bubbleCard" role="region" aria-label="Documentation navigation">
            <div class="component-info">
              <div class="aside-header">
                <div>
                  <div class="aside-title">Documentation</div>
                  <div class="aside-sub">Navigate Hellish docs</div>
                </div>
                <div style="display:flex;gap:.4rem;align-items:center;">
                  <button id="bubblePin" class="btn btn-sm" aria-pressed="false" title="Pin bubble">ğŸ“Œ</button>
                  <button id="bubbleClose" class="btn btn-sm" aria-label="Close panel">âœ•</button>
                </div>
              </div>
              <div class="aside-search">
                <input id="asideSearch" placeholder="Filter..." aria-label="Filter docs" />
              </div>
              <nav class="doc-nav" id="asideNav">
                <a href="#overview">Overview</a>
                <a href="#architecture">Architecture</a>
                <a href="#getting-started">Getting Started</a>
                <a href="#commands">Commands</a>
                <a href="#styling">Styling</a>
                <a href="#testing">Testing</a>
                <a href="#contributing">Contributing</a>
                <a href="#faq">FAQ</a>
              </nav>
              <div class="aside-actions" style="margin-top:8px;justify-content:flex-end;">
                <button id="bubblePrev" class="btn btn-sm" title="Prev">â€¹ Prev</button>
                <button id="bubbleNext" class="btn btn-sm" title="Next">Next â€º</button>
              </div>
            </div>
          </div>
        </aside>
       </div>
          <!-- Compact footer with modal-trigger links -->
      <footer class="hell-footer footer-mini" role="contentinfo" aria-label="Footer">
        <div class="container-fluid">
          <div class="row" style="align-items:center;justify-content:space-between;">
            <div class="col-4" style="display:flex;align-items:center;gap:0.75rem;">
              <div class="brand-badge" aria-hidden="true">H!</div>
              <div>
                <strong style="color:var(--hellish-primary);display:block;">Hellish Shell</strong>
                <small class="kv">POSIX-like shell â€¢ lightweight & extensible</small>
              </div>
            </div>

            <div class="col-4" style="text-align:center;">
              <!-- these links open a small floating modal with the details -->
              <a href="#" class="footer-link" data-modal="faq">FAQ</a>
              <a href="#" class="footer-link" data-modal="license">License</a>
              <a href="#" class="footer-link" data-modal="contribute">Contribute</a>
            </div>

            <div class="col-4" style="text-align:right;">
              <small class="kv">&copy; 2024 Hellish Shell â€” <a class="footer-link" href="https://github.com/Univers42/sh42" target="_blank" rel="noopener">Repository</a></small>
            </div>
          </div>
        </div>
      </footer>
  </main>

  <!-- Static Prev/Next controls (fixed, always visible) -->
  <div class="nav-controls" aria-hidden="false" aria-label="Article navigation">
    <button id="prevBtn" class="nav-btn nav-prev" aria-label="Previous article" title="Previous (â†)">â€¹</button>
    <button id="nextBtn" class="nav-btn nav-next" aria-label="Next article" title="Next (â†’)">â€º</button>
  </div>

  <!-- Floating TOC panel (built dynamically for 'architecture') -->
  <div id="floatingToc" class="floating-toc" aria-hidden="true" tabindex="-1" role="navigation" aria-label="Article table of contents">
    <div class="floating-toc-inner">
      <div class="floating-toc-header">
        <strong>On this page</strong>
        <button id="floatingTocClose" class="btn btn-sm" aria-label="Close table of contents">âœ•</button>
      </div>
      <nav id="floatingTocList" class="floating-toc-list" aria-label="Table of contents"></nav>
    </div>
  </div>

  <script src="page/main.js" defer></script>
</body>
</html>
